<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial Microsoft Excel - Impara Divertendoti!</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
            background:linear-gradient(135deg,#1d7a46 0%,#33a357 50%,#8fce00 100%);
            color:#333;min-height:100vh;
        }
        .container{max-width:1200px;margin:0 auto;padding:20px}
        
        .student-badge{
            background:linear-gradient(135deg,#217346 0%,#33a357 100%);
            color:#fff;padding:10px 20px;border-radius:50px;display:inline-block;
            margin-bottom:20px;font-weight:bold;box-shadow:0 3px 10px rgba(33,115,70,.3);
        }
        
        header{
            background:#fff;border-radius:20px;padding:30px;text-align:center;
            margin-bottom:30px;box-shadow:0 10px 30px rgba(33,115,70,.3);
            border-top:5px solid #217346;
        }
        h1{color:#217346;font-size:2.5em;margin-bottom:10px;text-shadow:2px 2px 4px rgba(33,115,70,.1)}
        .subtitle{color:#555;font-size:1.2em}
        nav{
            display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:30px;
        }
        .nav-btn{
            background:#fff;border:2px solid #217346;padding:15px 30px;border-radius:50px;
            font-size:1em;font-weight:bold;cursor:pointer;transition:.3s;
            box-shadow:0 5px 15px rgba(33,115,70,.2);color:#217346;
        }
        .nav-btn:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(33,115,70,.3);background:#f0f8f4}
        .nav-btn.active{
            background:linear-gradient(135deg,#217346 0%,#33a357 100%);
            color:#fff;border-color:#217346;
        }
        .content-section{display:none}
        .content-section.active{display:block;animation:fadeIn .5s}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .lessons-grid{
            display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;
        }
        .lesson-card{
            background:#fff;border-radius:15px;padding:25px;box-shadow:0 5px 20px rgba(33,115,70,.15);
            cursor:pointer;transition:.3s;display:flex;align-items:center;gap:20px;
            border:3px solid transparent;border-left:5px solid #217346;
        }
        .lesson-card:hover{
            transform:translateY(-5px);box-shadow:0 10px 30px rgba(33,115,70,.25);
            border-color:#33a357;background:linear-gradient(to right,#fff 0%,#f0fdf4 100%);
        }
        .lesson-card.completed{
            border-color:#33a357;background:linear-gradient(to right,#f0fdf4 0%,#dcfce7 100%);
            animation:pulse 2s infinite;
        }
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.03)}}
        .lesson-checkbox{
            width:40px;height:40px;border:3px solid #217346;border-radius:10px;
            display:flex;align-items:center;justify-content:center;font-size:1.8em;flex-shrink:0;background:#fff;
        }
        .lesson-card.completed .lesson-checkbox{background:#33a357;border-color:#33a357;color:#fff}
        .lesson-info{flex:1}
        .lesson-number{
            background:linear-gradient(135deg,#217346 0%,#33a357 100%);
            color:#fff;width:30px;height:30px;border-radius:50%;
            display:inline-flex;align-items:center;justify-content:center;
            font-weight:bold;font-size:.9em;margin-right:10px;box-shadow:0 2px 8px rgba(33,115,70,.3);
        }
        .lesson-title{color:#1a5c37;font-size:1.3em;font-weight:bold;margin-bottom:5px}
        .lesson-page{
            background:#fff;border-radius:20px;padding:30px;
            box-shadow:0 10px 30px rgba(33,115,70,.2);display:none;border-top:5px solid #217346;
        }
        .lesson-page.active{
            display:grid;grid-template-columns:1fr 300px;gap:30px;animation:fadeIn .5s;
        }
        .back-btn{
            background:linear-gradient(135deg,#217346 0%,#33a357 100%);
            color:#fff;border:none;padding:12px 25px;border-radius:10px;
            font-size:1em;cursor:pointer;margin-bottom:20px;transition:.3s;
            box-shadow:0 3px 10px rgba(33,115,70,.3);
        }
        .back-btn:hover{
            background:linear-gradient(135deg,#1a5c37 0%,#2b8a4a 100%);
            transform:translateX(-5px);box-shadow:0 5px 15px rgba(33,115,70,.4);
        }
        .lesson-sidebar{
            background:linear-gradient(to bottom,#f0fdf4 0%,#dcfce7 100%);
            padding:25px;border-radius:15px;position:sticky;top:20px;
            height:fit-content;border:2px solid #bbf7d0;
        }
        .section-block{
            background:linear-gradient(to right,#f0fdf4 0%,#fff 100%);
            padding:25px;border-radius:15px;margin-bottom:25px;
            border-left:5px solid #217346;box-shadow:0 3px 10px rgba(33,115,70,.1);
        }
        .section-block h3{color:#217346;margin-bottom:15px;font-size:1.5em}
        .section-block p{line-height:1.8;margin-bottom:8px}
        .section-block ul,.section-block ol{margin-left:20px;line-height:1.8;margin-bottom:8px}
        .section-block li{margin-bottom:4px}
        .example-box{
            background:#fff8e1;border-left:4px solid #ffa726;
            padding:15px;margin:12px 0;border-radius:8px;
        }
        .example-box strong{color:#f57c00;display:block;margin-bottom:6px}
        .tip-box{
            background:#e3f2fd;border-left:4px solid #2196f3;
            padding:15px;margin:12px 0;border-radius:8px;
        }
        .tip-box strong{color:#1976d2;display:block;margin-bottom:6px}
        .code-example{
            background:#2d2d2d;color:#8fce00;padding:10px 15px;
            border-radius:8px;font-family:'Courier New',monospace;
            margin:10px 0;border-left:4px solid #217346;white-space:pre-wrap;
        }
        .video-placeholder{
            background:linear-gradient(135deg,#217346 0%,#33a357 50%,#8fce00 100%);
            color:#fff;padding:60px 20px;border-radius:15px;text-align:center;
            margin:15px 0;font-size:1.1em;box-shadow:0 5px 20px rgba(33,115,70,.3);
            position:relative;overflow:hidden;
        }
        .video-placeholder::before{
            content:'‚ñ∂';position:absolute;top:50%;left:50%;
            transform:translate(-50%,-50%);font-size:3em;opacity:.25;
        }
        .exercise-content{
            background:linear-gradient(to right,#fef3c7 0%,#fef9e6 100%);
            padding:20px;border-radius:10px;border-left:5px solid #f59e0b;
        }
        .exercise-content h4{color:#d97706;margin-bottom:8px}
        .exercise-list{line-height:1.8}
        .sidebar-check{
            background:#fff;padding:15px;margin:10px 0;border-radius:10px;
            display:flex;align-items:center;gap:12px;cursor:pointer;transition:.3s;
            border:2px solid #bbf7d0;
        }
        .sidebar-check:hover{border-color:#217346;transform:translateX(3px);background:#f0fdf4}
        .sidebar-check.checked{
            background:linear-gradient(to right,#dcfce7 0%,#bbf7d0 100%);
            border-color:#33a357;
        }
        .mini-checkbox{
            width:25px;height:25px;border:2px solid #217346;border-radius:6px;
            display:flex;align-items:center;justify-content:center;font-size:1.2em;
        }
        .sidebar-check.checked .mini-checkbox{background:#33a357;border-color:#33a357;color:#fff}
        .other-section{
            background:#fff;border-radius:20px;padding:30px;
            box-shadow:0 10px 30px rgba(33,115,70,.2);border-top:5px solid #217346;
        }
        .glossary-term{
            background:linear-gradient(to right,#f0fdf4 0%,#fff 100%);
            padding:20px;margin:10px 0;border-radius:10px;border-left:5px solid #217346;
        }
        .glossary-term strong{color:#217346;font-size:1.1em;display:block;margin-bottom:5px}
        .shortcut{
            background:linear-gradient(to right,#f0fdf4 0%,#fff 100%);
            padding:10px 15px;margin:6px 0;border-radius:10px;border-left:3px solid #217346;
        }
        .shortcut-header{
            display:flex;justify-content:space-between;align-items:center;
        }
        .shortcut-key{
            background:linear-gradient(135deg,#217346 0%,#33a357 100%);
            color:#fff;padding:4px 8px;border-radius:6px;
            font-family:'Courier New',monospace;font-size:.85em;
        }
        .shortcut-desc{font-size:.85em;color:#444;margin-top:3px}
        .category{margin-bottom:25px}
        .category h3{
            color:#217346;margin-bottom:10px;padding-bottom:8px;
            border-bottom:3px solid #217346;font-size:1.15em;
        }
        .progress-bar{
            background:#e5e7eb;height:30px;border-radius:15px;margin:20px 0;
            overflow:hidden;border:2px solid #bbf7d0;
        }
        .progress-fill{
            background:linear-gradient(90deg,#217346 0%,#33a357 50%,#8fce00 100%);
            height:100%;width:0%;transition:.5s;display:flex;
            align-items:center;justify-content:center;color:#fff;font-weight:bold;
        }
        @media(max-width:768px){
            .lesson-page.active{grid-template-columns:1fr}
            .lesson-sidebar{position:relative;top:0;margin-top:20px}
            h1{font-size:1.8em}
            .nav-btn{padding:10px 18px;font-size:.9em}
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="student-badge" id="student-badge">üë§ Caricamento...</div>
        <h1>üìä Tutorial Microsoft Excel</h1>
        <p class="subtitle">Lezioni, glossario ed esercizi interattivi per imparare Excel passo dopo passo.</p>
        <div class="progress-bar">
            <div class="progress-fill" id="overall-progress">0%</div>
        </div>
    </header>

    <nav>
        <button class="nav-btn active" onclick="showMainSection('home', event)">üìö Lezioni</button>
        <button class="nav-btn" onclick="showMainSection('glossario', event)">üìñ Glossario</button>
        <button class="nav-btn" onclick="showMainSection('comandi', event)">‚å®Ô∏è Comandi Rapidi</button>
    </nav>

    <!-- HOME LEZIONI -->
    <div id="home" class="content-section active">
        <div class="other-section">
            <h2 style="color:#217346;margin-bottom:20px">Scegli una lezione per iniziare</h2>
            <div class="lessons-grid">
                <div class="lesson-card" onclick="openLesson(1)" data-lesson="1">
                    <div class="lesson-checkbox"></div>
                    <div class="lesson-info">
                        <div class="lesson-title">
                            <span class="lesson-number">1</span> Introduzione a Microsoft Excel
                        </div>
                        <p>Cos'√® Excel, interfaccia e primi passi.</p>
                    </div>
                </div>
                <div class="lesson-card" onclick="openLesson(2)" data-lesson="2">
                    <div class="lesson-checkbox"></div>
                    <div class="lesson-info">
                        <div class="lesson-title">
                            <span class="lesson-number">2</span> Celle, Righe e Colonne
                        </div>
                        <p>Struttura del foglio, intervalli, selezioni e inserimento dati.</p>
                    </div>
                </div>
                <div class="lesson-card" onclick="openLesson(3)" data-lesson="3">
                    <div class="lesson-checkbox"></div>
                    <div class="lesson-info">
                        <div class="lesson-title">
                            <span class="lesson-number">3</span> Formule di Base
                        </div>
                        <p>Operatori, SOMMA, MEDIA, MAX, MIN e esempi pratici.</p>
                    </div>
                </div>
                <div class="lesson-card" onclick="openLesson(4)" data-lesson="4">
                    <div class="lesson-checkbox"></div>
                    <div class="lesson-info">
                        <div class="lesson-title">
                            <span class="lesson-number">4</span> Formattazione e Stile
                        </div>
                        <p>Formati numero, allineamento, colori, bordi e formattazione condizionale.</p>
                    </div>
                </div>
                <div class="lesson-card" onclick="openLesson(5)" data-lesson="5">
                    <div class="lesson-checkbox"></div>
                    <div class="lesson-info">
                        <div class="lesson-title">
                            <span class="lesson-number">5</span> Grafici e Visualizzazioni
                        </div>
                        <p>Tipi di grafici, quando usarli e personalizzazione.</p>
                    </div>
                </div>
                <div class="lesson-card" onclick="openLesson(6)" data-lesson="6">
                    <div class="lesson-checkbox"></div>
                    <div class="lesson-info">
                        <div class="lesson-title">
                            <span class="lesson-number">6</span> Filtri e Ordinamento
                        </div>
                        <p>Gestire liste e database con filtri e ordinamenti.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Le 6 LEZIONI seguono qui - uso il tuo codice originale ma abbrevio per spazio -->
    <!-- LEZIONE 1 -->
    <div id="lesson-1" class="lesson-page">
        <div class="lesson-content">
            <button class="back-btn" onclick="backToHome()">‚Üê Torna alle lezioni</button>
            <h2 style="color:#217346;margin-bottom:20px">Lezione 1: Introduzione a Microsoft Excel</h2>

            <div class="section-block">
                <h3>üìñ Spiegazione</h3>
                <p><strong>Cos'√® Excel?</strong> Excel √® un foglio di calcolo, cio√® una grande tabella digitale composta da celle, dove puoi inserire numeri, testi e formule che si aggiornano automaticamente.</p>
                <p>√à uno strumento fondamentale in uffici, aziende e scuole per creare tabelle, fare calcoli, analizzare dati e produrre report professionali con grafici.</p>

                <div class="example-box">
                    <strong>üìå Esempio pratico</strong>
                    Nella stessa cartella di lavoro puoi avere:
                    - un foglio per il registro voti
                    - uno per le spese personali
                    - uno per il piano di studio
                    Tutti collegati con formule e grafici.
                </div>

                <p><strong>Elementi principali dell'interfaccia</strong></p>
                <ul>
                    <li><strong>Barra multifunzione:</strong> contiene schede (Home, Inserisci, Formule, Dati...) con tutti i comandi.</li>
                    <li><strong>Casella Nome:</strong> mostra l'indirizzo della cella attiva (es. A1).</li>
                    <li><strong>Barra della formula:</strong> mostra/consente di modificare il contenuto della cella.</li>
                    <li><strong>Area di lavoro:</strong> la griglia di righe e colonne.</li>
                    <li><strong>Schede dei fogli:</strong> in basso, per passare da un foglio all'altro.</li>
                </ul>

                <div class="tip-box">
                    <strong>üí° Suggerimento</strong>
                    Usa spesso Ctrl+Z per annullare l'ultima azione: puoi sperimentare senza paura di rovinare il file.
                </div>
            </div>

            <div class="section-block">
                <h3>üé• Video Tutorial</h3>
                <div class="video-placeholder">
                    Video: "I primi passi in Excel"<br>
                    <small>Inserisci qui il link del tuo video YouTube</small>
                </div>
            </div>

            <div class="section-block">
                <h3>üí™ Esercizio pratico</h3>
                <div class="exercise-content">
                    <h4>Crea la tua prima cartella di lavoro</h4>
                    <div class="exercise-list">
                        1. Apri Excel e scegli "Cartella di lavoro vuota".<br>
                        2. Premi Ctrl+S e salva il file come "Profilo_studente.xlsx".<br>
                        3. In A1 scrivi "Nome", in B1 "Classe", in C1 "Data".<br>
                        4. Compila la riga 2 con i tuoi dati.<br>
                        5. Rinomina il foglio da "Foglio1" a "Dati personali".<br>
                        6. Salva di nuovo (Ctrl+S).
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson-sidebar">
            <h3 style="color:#217346;margin-bottom:15px">‚úÖ Checklist</h3>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,1,'spiegazione')">
                <div class="mini-checkbox"></div><span>Spiegazione letta</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,1,'video')">
                <div class="mini-checkbox"></div><span>Video visto</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,1,'esercizio')">
                <div class="mini-checkbox"></div><span>Esercizio completato</span>
            </div>
        </div>
    </div>

    <!-- LEZIONE 2 -->
    <div id="lesson-2" class="lesson-page">
        <div class="lesson-content">
            <button class="back-btn" onclick="backToHome()">‚Üê Torna alle lezioni</button>
            <h2 style="color:#217346;margin-bottom:20px">Lezione 2: Celle, Righe e Colonne</h2>

            <div class="section-block" id="spiegazione-2">
                <h3>üìñ Spiegazione</h3>
                <p>Un foglio Excel √® organizzato in colonne (lettere) e righe (numeri). L'intersezione tra una colonna e una riga √® una cella, identificata da un indirizzo come A1, C5 o AB12.</p>
                <p>Un intervallo √® un gruppo di celle adiacenti, indicato con l'indirizzo della prima e dell'ultima cella separate dai due punti, ad esempio A1:A10 o A1:D10.</p>

                <div class="example-box">
                    <strong>üìå Esempi di indirizzi</strong>
                    - A1 ‚Üí colonna A, riga 1<br>
                    - C7 ‚Üí colonna C, riga 7<br>
                    - A1:C3 ‚Üí rettangolo di 3√ó3 celle<br>
                    - A:A ‚Üí tutta la colonna A<br>
                    - 1:1 ‚Üí tutta la riga 1
                </div>

                <div class="tip-box">
                    <strong>üí° Navigazione veloce</strong>
                    - Frecce ‚Üí una cella alla volta<br>
                    - Ctrl+Frecce ‚Üí salta all'ultima cella piena in quella direzione<br>
                    - Ctrl+Home ‚Üí torna alla cella A1<br>
                    - Ctrl+Fine ‚Üí va all'ultima cella usata
                </div>
            </div>

            <div class="section-block" id="video-2">
                <h3>üé• Video Tutorial</h3>
                <div class="video-placeholder">
                    Video: "Muoversi nel foglio e usare gli intervalli"<br>
                    <small>Inserisci qui il link del tuo video YouTube</small>
                </div>
            </div>

            <div class="section-block" id="esercizio-2">
                <h3>üí™ Esercizio pratico</h3>
                <div class="exercise-content">
                    <h4>Crea l'orario delle lezioni</h4>
                    <div class="exercise-list">
                        1. In B1:F1 scrivi i giorni (Luned√¨‚ÄìVenerd√¨).<br>
                        2. In A2:A7 inserisci le ore (es. 8:00, 9:00, 10:00...).<br>
                        3. Compila B2:F7 con le materie corrispondenti.<br>
                        4. Seleziona A1:F1 e applica grassetto e sfondo verde chiaro.<br>
                        5. Seleziona A1:F7 e applica "Tutti i bordi".<br>
                        6. Salva il file come "Orario.xlsx".
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson-sidebar">
            <h3 style="color:#217346;margin-bottom:15px">‚úÖ Checklist</h3>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,2,'spiegazione')">
                <div class="mini-checkbox"></div><span>Spiegazione letta</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,2,'video')">
                <div class="mini-checkbox"></div><span>Video visto</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,2,'esercizio')">
                <div class="mini-checkbox"></div><span>Esercizio completato</span>
            </div>
        </div>
    </div>

    <!-- LEZIONE 3 -->
    <div id="lesson-3" class="lesson-page">
        <div class="lesson-content">
            <button class="back-btn" onclick="backToHome()">‚Üê Torna alle lezioni</button>
            <h2 style="color:#217346;margin-bottom:20px">Lezione 3: Formule di Base</h2>

            <div class="section-block" id="spiegazione-3">
                <h3>üìñ Spiegazione</h3>
                <p>Le formule permettono di eseguire calcoli automatici sui dati. Devono sempre iniziare con il simbolo =, altrimenti Excel interpreta il contenuto come testo.</p>

                <p><strong>Operatori principali</strong></p>
                <ul>
                    <li>=A1+B1 ‚Üí somma</li>
                    <li>=A1-B1 ‚Üí sottrazione</li>
                    <li>=A1*B1 ‚Üí moltiplicazione</li>
                    <li>=A1/B1 ‚Üí divisione</li>
                </ul>

                <p><strong>Funzioni base</strong></p>
                <div class="code-example">
=SOMMA(B2:B6)   ‚Üí somma gli importi
=MEDIA(B2:B6)   ‚Üí media dei valori
=MAX(B2:B6)     ‚Üí valore massimo
=MIN(B2:B6)     ‚Üí valore minimo
                </div>

                <div class="example-box">
                    <strong>üìå Esempio: spese mensili</strong>
                    Inserisci 5 categorie in A2:A6 e i relativi importi in B2:B6.<br>
                    In B8 scrivi =SOMMA(B2:B6) per il totale.<br>
                    In B9 scrivi =MEDIA(B2:B6) per la spesa media.<br>
                    Se cambi un importo, totale e media si aggiornano automaticamente.
                </div>

                <div class="tip-box">
                    <strong>üí° AutoSomma veloce</strong>
                    Seleziona la colonna di importi pi√π la cella vuota sotto e premi Alt+= per inserire automaticamente SOMMA.
                </div>
            </div>

            <div class="section-block" id="video-3">
                <h3>üé• Video Tutorial</h3>
                <div class="video-placeholder">
                    Video: "Prime formule e funzioni principali"<br>
                    <small>Inserisci qui il link del tuo video YouTube</small>
                </div>
            </div>

            <div class="section-block" id="esercizio-3">
                <h3>üí™ Esercizio pratico</h3>
                <div class="exercise-content">
                    <h4>Crea un foglio "Spese mensili"</h4>
                    <div class="exercise-list">
                        1. A1: Categoria, B1: Importo (‚Ç¨).<br>
                        2. Inserisci almeno 5 categorie con importi in B2:B6.<br>
                        3. A8: "Totale", B8: =SOMMA(B2:B6).<br>
                        4. A9: "Media", B9: =MEDIA(B2:B6).<br>
                        5. A10: "Max", B10: =MAX(B2:B6).<br>
                        6. A11: "Min", B11: =MIN(B2:B6).<br>
                        7. Applica formato valuta a B2:B11.
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson-sidebar">
            <h3 style="color:#217346;margin-bottom:15px">‚úÖ Checklist</h3>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,3,'spiegazione')">
                <div class="mini-checkbox"></div><span>Spiegazione letta</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,3,'video')">
                <div class="mini-checkbox"></div><span>Video visto</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,3,'esercizio')">
                <div class="mini-checkbox"></div><span>Esercizio completato</span>
            </div>
        </div>
    </div>

    <!-- LEZIONE 4 -->
    <div id="lesson-4" class="lesson-page">
        <div class="lesson-content">
            <button class="back-btn" onclick="backToHome()">‚Üê Torna alle lezioni</button>
            <h2 style="color:#217346;margin-bottom:20px">Lezione 4: Formattazione e Stile</h2>

            <div class="section-block" id="spiegazione-4">
                <h3>üìñ Spiegazione</h3>
                <p>La formattazione rende il foglio pi√π leggibile e professionale senza modificare i valori reali dei dati.</p>

                <p><strong>Formati numero</strong></p>
                <ul>
                    <li>Numero (decimali fissi)</li>
                    <li>Valuta (‚Ç¨)</li>
                    <li>Percentuale</li>
                    <li>Data/Ora</li>
                </ul>

                <p><strong>Testo e allineamento</strong></p>
                <ul>
                    <li>Grassetto, corsivo, sottolineato</li>
                    <li>Allineamento a sinistra, centro, destra</li>
                    <li>Unisci e centra per titoli sopra le tabelle</li>
                </ul>

                <p><strong>Bordi e colori</strong></p>
                <p>Puoi usare bordi per definire le tabelle e colori di riempimento per evidenziare celle importanti.</p>

                <p><strong>Formattazione condizionale</strong></p>
                <p>Permette di colorare automaticamente le celle in base al valore (es. voti inferiori a 6 in rosso, superiori o uguali a 8 in verde).</p>

                <div class="example-box">
                    <strong>üìå Esempio: registro voti leggibile</strong>
                    - Intestazione con sfondo verde e testo bianco.<br>
                    - Righe alterne bianche/grigio chiaro.<br>
                    - Voti ‚â•8 colorati di verde con formattazione condizionale.
                </div>
            </div>

            <div class="section-block" id="video-4">
                <h3>üé• Video Tutorial</h3>
                <div class="video-placeholder">
                    Video: "Rendere un foglio bello e professionale"<br>
                    <small>Inserisci qui il link del tuo video YouTube</small>
                </div>
            </div>

            <div class="section-block" id="esercizio-4">
                <h3>üí™ Esercizio pratico</h3>
                <div class="exercise-content">
                    <h4>Registro voti formattato</h4>
                    <div class="exercise-list">
                        1. Crea le colonne: Materia, Voto, Data, Note.<br>
                        2. Inserisci almeno 6 righe di dati realistici.<br>
                        3. Formatta la riga 1 con sfondo verde scuro e testo bianco.<br>
                        4. Applica bordi a tutta la tabella.<br>
                        5. Applica formattazione condizionale ai voti: rosso se &lt;6, verde se ‚â•8.<br>
                        6. Trasforma l'intervallo in "Tabella" (Home ‚Üí Formatta come tabella).
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson-sidebar">
            <h3 style="color:#217346;margin-bottom:15px">‚úÖ Checklist</h3>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,4,'spiegazione')">
                <div class="mini-checkbox"></div><span>Spiegazione letta</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,4,'video')">
                <div class="mini-checkbox"></div><span>Video visto</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,4,'esercizio')">
                <div class="mini-checkbox"></div><span>Esercizio completato</span>
            </div>
        </div>
    </div>

    <!-- LEZIONE 5 -->
    <div id="lesson-5" class="lesson-page">
        <div class="lesson-content">
            <button class="back-btn" onclick="backToHome()">‚Üê Torna alle lezioni</button>
            <h2 style="color:#217346;margin-bottom:20px">Lezione 5: Grafici e Visualizzazioni</h2>

            <div class="section-block" id="spiegazione-5">
                <h3>üìñ Spiegazione</h3>
                <p>I grafici trasformano numeri in immagini facili da interpretare. Excel offre grafici a colonne, barre, linee, torta, dispersione e altri tipi.</p>
                <p>Per creare un grafico serve una tabella ordinata con intestazioni chiare nelle righe o nelle colonne.</p>

                <div class="example-box">
                    <strong>üìå Quando usare i vari grafici</strong>
                    - Colonne/Barre: confrontare valori tra materie o categorie.<br>
                    - Linee: mostrare l'andamento nel tempo (voti nel corso dell'anno).<br>
                    - Torta: mostrare percentuali di un totale (ripartizione budget).<br>
                    - Dispersione: analizzare la relazione tra due variabili (studio vs voto).
                </div>

                <p><strong>Componenti principali di un grafico</strong></p>
                <ul>
                    <li>Titolo del grafico</li>
                    <li>Assi (X e Y)</li>
                    <li>Legenda (nomi delle serie)</li>
                    <li>Etichette dati (valori sopra le colonne o i punti)</li>
                </ul>
            </div>

            <div class="section-block" id="video-5">
                <h3>üé• Video Tutorial</h3>
                <div class="video-placeholder">
                    Video: "Creare grafici efficaci in Excel"<br>
                    <small>Inserisci qui il link del tuo video YouTube</small>
                </div>
            </div>

            <div class="section-block" id="esercizio-5">
                <h3>üí™ Esercizio pratico</h3>
                <div class="exercise-content">
                    <h4>Grafico dei voti per materia</h4>
                    <div class="exercise-list">
                        1. Crea una tabella con A1: Materia e B1: Voto.<br>
                        2. In A2:A7 inserisci 6 materie, in B2:B7 i tuoi voti.<br>
                        3. Seleziona A1:B7 e vai su Inserisci ‚Üí Grafico a colonne.<br>
                        4. Imposta il titolo del grafico su "Voti per materia".<br>
                        5. Aggiungi le etichette dati per vedere i valori sopra le colonne.<br>
                        6. Prova a cambiare il tipo di grafico (barre, linee) e osserva le differenze.
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson-sidebar">
            <h3 style="color:#217346;margin-bottom:15px">‚úÖ Checklist</h3>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,5,'spiegazione')">
                <div class="mini-checkbox"></div><span>Spiegazione letta</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,5,'video')">
                <div class="mini-checkbox"></div><span>Video visto</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,5,'esercizio')">
                <div class="mini-checkbox"></div><span>Esercizio completato</span>
            </div>
        </div>
    </div>

    <!-- LEZIONE 6 -->
    <div id="lesson-6" class="lesson-page">
        <div class="lesson-content">
            <button class="back-btn" onclick="backToHome()">‚Üê Torna alle lezioni</button>
            <h2 style="color:#217346;margin-bottom:20px">Lezione 6: Filtri e Ordinamento</h2>

            <div class="section-block" id="spiegazione-6">
                <h3>üìñ Spiegazione</h3>
                <p>L'ordinamento cambia l'ordine delle righe (ad esempio dalla A alla Z, o dal valore pi√π grande al pi√π piccolo).</p>
                <p>I filtri permettono di mostrare solo le righe che rispettano certe condizioni (es. solo gli studenti con voto ‚â•8).</p>

                <div class="example-box">
                    <strong>üìå Esempio: elenco studenti</strong>
                    In una tabella con Nome, Classe, Voto:<br>
                    - Ordinamento crescente per Voto per vedere chi ha preso i voti pi√π bassi.<br>
                    - Filtro su Classe per vedere solo una classe specifica.<br>
                    - Filtro su Voto ‚â• 8 per vedere solo i migliori risultati.
                </div>
            </div>

            <div class="section-block" id="video-6">
                <h3>üé• Video Tutorial</h3>
                <div class="video-placeholder">
                    Video: "Filtri e ordinamenti su liste in Excel"<br>
                    <small>Inserisci qui il link del tuo video YouTube</small>
                </div>
            </div>

            <div class="section-block" id="esercizio-6">
                <h3>üí™ Esercizio pratico</h3>
                <div class="exercise-content">
                    <h4>Gestisci un elenco di studenti</h4>
                    <div class="exercise-list">
                        1. Crea le colonne: Nome, Classe, Voto, Assenze.<br>
                        2. Inserisci almeno 10 righe di esempio realistico.<br>
                        3. Seleziona la tabella e attiva il filtro (Ctrl+Shift+L o Dati ‚Üí Filtro).<br>
                        4. Ordina per Voto dal pi√π alto al pi√π basso.<br>
                        5. Filtra per vedere solo gli studenti con voto ‚â• 8.<br>
                        6. Filtra per una singola classe e osserva come cambiano i risultati.
                    </div>
                </div>
            </div>
        </div>

        <div class="lesson-sidebar">
            <h3 style="color:#217346;margin-bottom:15px">‚úÖ Checklist</h3>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,6,'spiegazione')">
                <div class="mini-checkbox"></div><span>Spiegazione letta</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,6,'video')">
                <div class="mini-checkbox"></div><span>Video visto</span>
            </div>
            <div class="sidebar-check" onclick="toggleSidebarCheck(this,6,'esercizio')">
                <div class="mini-checkbox"></div><span>Esercizio completato</span>
            </div>
        </div>
    </div>

    <!-- GLOSSARIO -->
    <div id="glossario" class="content-section">
        <div class="other-section">
            <h2 style="color:#217346;margin-bottom:20px">üìñ Glossario dei Termini Excel</h2>
            <div class="glossary-term">
                <strong>üìä Cella</strong>
                L'unit√† base del foglio di calcolo. Ogni cella ha un indirizzo (es. A1) e pu√≤ contenere testo, numeri o formule.
            </div>
            <div class="glossary-term">
                <strong>üìê Formula</strong>
                Istruzione che esegue un calcolo. Inizia sempre con = e pu√≤ usare numeri, operatori (+, -, *, /) e riferimenti a celle.
            </div>
            <div class="glossary-term">
                <strong>‚ûó Funzione</strong>
                Formula predefinita che svolge un compito specifico (es. SOMMA, MEDIA, SE). Riduce errori e velocizza i calcoli.
            </div>
            <div class="glossary-term">
                <strong>üéØ Riferimento di cella</strong>
                Il modo in cui una formula indica una cella (A1) o un intervallo (A1:A10). Pu√≤ essere relativo (A1), assoluto ($A$1) o misto ($A1, A$1).
            </div>
            <div class="glossary-term">
                <strong>üìä Intervallo</strong>
                Gruppo di celle contigue indicato con due indirizzi separati da ":", ad esempio A1:D10. Usato spesso nelle funzioni.
            </div>
            <div class="glossary-term">
                <strong>üìÅ Cartella di lavoro</strong>
                Il file Excel (.xlsx) che contiene uno o pi√π fogli di lavoro.
            </div>
            <div class="glossary-term">
                <strong>üìÑ Foglio di lavoro</strong>
                Una singola pagina all'interno della cartella di lavoro, richiamata dalle schede in basso (Foglio1, Foglio2‚Ä¶).
            </div>
            <div class="glossary-term">
                <strong>üé® Formattazione</strong>
                Insieme di impostazioni grafiche (font, colore, bordi, formati numero) che rendono il foglio pi√π leggibile senza cambiare i valori.
            </div>
            <div class="glossary-term">
                <strong>üìà Grafico</strong>
                Rappresentazione visiva dei dati (colonne, linee, torta, ecc.) basata su una tabella.
            </div>
            <div class="glossary-term">
                <strong>üîç Filtro</strong>
                Strumento che mostra solo le righe che rispettano una certa condizione (es. voti ‚â• 8), nascondendo temporaneamente le altre.
            </div>
            <div class="glossary-term">
                <strong>üî§ Ordinamento</strong>
                Operazione che riordina le righe in base ai valori di una colonna (A‚ÜíZ, Z‚ÜíA, crescente, decrescente).
            </div>
            <div class="glossary-term">
                <strong>üìä Tabella</strong>
                Intervallo formattato come tabella (Home ‚Üí Formatta come tabella) con filtri automatici, stili e riferimenti strutturati.
            </div>
            <div class="glossary-term">
                <strong>ü§ñ Macro</strong>
                Sequenza di comandi registrata o scritta in VBA per automatizzare operazioni ripetitive in Excel.
            </div>
        </div>
    </div>

    <!-- COMANDI RAPIDI -->
    <div id="comandi" class="content-section">
        <div class="other-section">
            <h2 style="color:#217346;margin-bottom:20px">‚å®Ô∏è Comandi Rapidi da Tastiera</h2>
            <div class="category">
                <h3>üéØ Navigazione</h3>
                <div class="shortcut">
                    <div class="shortcut-header">
                        <span>Muoversi tra le celle</span>
                        <span class="shortcut-key">‚Üë ‚Üì ‚Üê ‚Üí</span>
                    </div>
                </div>
                <!-- Aggiungi gli altri comandi dal tuo file -->
            </div>
        </div>
    </div>
</div>

<script>
    // SOSTITUISCI CON IL TUO URL GOOGLE APPS SCRIPT
    const TRACKING_URL = 'https://script.google.com/macros/s/AKfycbz1y4PeTOF8OenQe0mH7jMWhVUtqy6nb-7hQfbmdp8elv3e3Lz08AgjSwuu7LfzLf_c/exec';

    let studentData = {
        id: '',
        nome: '',
        cognome: '',
        classe: '',
        email: ''
    };

    // Leggi parametri dall'URL
    function getUrlParam(name) {
        const url = new URLSearchParams(window.location.search);
        return url.get(name) || '';
    }

    // Inizializza studente
    function initStudent() {
        studentData.id = getUrlParam('id');
        studentData.nome = getUrlParam('nome');
        studentData.cognome = getUrlParam('cognome');
        studentData.classe = getUrlParam('classe');
        studentData.email = getUrlParam('email');

        if (studentData.nome && studentData.cognome) {
            document.getElementById('student-badge').textContent = `üë§ ${studentData.nome} ${studentData.cognome} - ${studentData.classe}`;
            localStorage.setItem(`student_${studentData.id}`, JSON.stringify(studentData));
            sendToGoogleSheet('ACCESSO', 'Apertura tutorial');
            updateProgress();
        } else {
            document.getElementById('student-badge').textContent = '‚ö†Ô∏è Link non valido';
        }
    }

    // Invia dati al Google Sheet
    function sendToGoogleSheet(action, details) {
        if (!studentData.id) return;

        const data = {
            timestamp: new Date().toLocaleString('it-IT'),
            id: studentData.id,
            nome: studentData.nome,
            cognome: studentData.cognome,
            classe: studentData.classe,
            email: studentData.email,
            azione: action,
            dettagli: details
        };

        fetch(TRACKING_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        }).catch(err => console.log('Tracking:', err));
    }

    function updateProgress() {
        if (!studentData.id) return;
        
        const totalLessons = 6;
        const totalChecksPerLesson = 3;
        const totalChecks = totalLessons * totalChecksPerLesson;

        let completedChecks = 0;
        for (let i = 1; i <= totalLessons; i++) {
            completedChecks += parseInt(localStorage.getItem(`student_${studentData.id}_lesson${i}-completed`) || 0);
        }

        const percentage = Math.round((completedChecks / totalChecks) * 100);
        const progressFill = document.getElementById('overall-progress');
        progressFill.style.width = percentage + '%';
        progressFill.textContent = percentage + '%';

        for (let i = 1; i <= totalLessons; i++) {
            const completed = parseInt(localStorage.getItem(`student_${studentData.id}_lesson${i}-completed`) || 0);
            const card = document.querySelector(`.lesson-card[data-lesson="${i}"]`);
            const checkbox = card.querySelector('.lesson-checkbox');

            if (completed === totalChecksPerLesson) {
                card.classList.add('completed');
                checkbox.textContent = '‚úì';
            } else {
                card.classList.remove('completed');
                checkbox.textContent = '';
            }
        }
        
        if (percentage > 0) {
            sendToGoogleSheet('PROGRESSO', `Completamento: ${percentage}%`);
        }
    }

    function showMainSection(sectionId, event) {
        document.querySelectorAll('.content-section').forEach(sec => sec.classList.remove('active'));
        document.querySelectorAll('.lesson-page').forEach(page => page.classList.remove('active'));
        document.getElementById(sectionId).classList.add('active');

        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        if (event && event.target) event.target.classList.add('active');

        sendToGoogleSheet('NAVIGAZIONE', `Sezione: ${sectionId}`);
    }

    function openLesson(lessonNum) {
        document.getElementById('home').classList.remove('active');
        document.getElementById(`lesson-${lessonNum}`).classList.add('active');
        loadLessonState(lessonNum);

        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector('.nav-btn').classList.add('active');

        sendToGoogleSheet('LEZIONE_APERTA', `Lezione ${lessonNum}`);
    }

    function backToHome() {
        document.querySelectorAll('.lesson-page').forEach(page => page.classList.remove('active'));
        document.getElementById('home').classList.add('active');

        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector('.nav-btn').classList.add('active');
    }

    function toggleSidebarCheck(element, lessonNum, type) {
        element.classList.toggle('checked');
        const key = `student_${studentData.id}_lesson${lessonNum}-${type}`;
        const isChecked = element.classList.contains('checked');
        localStorage.setItem(key, isChecked ? '1' : '0');

        const checkbox = element.querySelector('.mini-checkbox');
        checkbox.textContent = isChecked ? '‚úì' : '';

        updateLessonCompletion(lessonNum);
        updateProgress();

        if (isChecked) {
            sendToGoogleSheet('CHECKLIST', `Lezione ${lessonNum} - ${type} completato`);
        }
    }

    function loadLessonState(lessonNum) {
        const types = ['spiegazione', 'video', 'esercizio'];
        types.forEach(type => {
            const key = `student_${studentData.id}_lesson${lessonNum}-${type}`;
            const isChecked = localStorage.getItem(key) === '1';
            const checkElement = document.querySelector(`#lesson-${lessonNum} .sidebar-check[onclick*="${type}"]`);
            if (checkElement) {
                checkElement.classList.toggle('checked', isChecked);
                checkElement.querySelector('.mini-checkbox').textContent = isChecked ? '‚úì' : '';
            }
        });
    }

    function updateLessonCompletion(lessonNum) {
        const types = ['spiegazione', 'video', 'esercizio'];
        let completedCount = 0;
        types.forEach(type => {
            const key = `student_${studentData.id}_lesson${lessonNum}-${type}`;
            if (localStorage.getItem(key) === '1') completedCount++;
        });
        localStorage.setItem(`student_${studentData.id}_lesson${lessonNum}-completed`, completedCount);

        if (completedCount === 3) {
            sendToGoogleSheet('LEZIONE_COMPLETATA', `Lezione ${lessonNum} al 100%`);
        }
    }

    document.addEventListener('DOMContentLoaded', initStudent);
</script>
</body>
</html>
